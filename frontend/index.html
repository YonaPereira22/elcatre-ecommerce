<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>El Catre S.R.L — Mueblería</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="styles.css">
  <style>
    :root{--azul:#17468f;--azul2:#0f3266;--blanco:#fff;--gris:#f3f5f7;--tx:#111}
    body{margin:0;font-family:Arial,Helvetica,sans-serif;background:linear-gradient(180deg,#f7f9ff 0%,#fff 100%);color:var(--tx)}
    a{color:inherit;text-decoration:none}
    .container{max-width:1100px;margin:0 auto;padding:0 16px}

    /* NAV */
    .topbar{position:sticky;top:0;z-index:40;background:var(--azul);color:#fff;border-bottom:1px solid rgba(255,255,255,.1)}
    .topbar .wrap{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:10px 0}
    .brand{display:flex;align-items:center;gap:10px}
    .brand img{height:34px;border-radius:6px}
    .brand strong{font-size:18px;letter-spacing:.3px}
    .menu{display:flex;gap:10px;flex-wrap:wrap}
    .menu a{padding:8px 10px;border-radius:8px}
    .menu a:hover{background:rgba(255,255,255,.12)}
    .auth{display:flex;gap:8px;align-items:center}
    .btn{padding:8px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.5);background:transparent;color:#fff;cursor:pointer;font-weight:600}
    .btn.white{background:#fff;color:var(--azul);border-color:#fff}

    /* HERO */
    .hero{display:grid;grid-template-columns:1fr 340px;gap:18px;align-items:stretch;padding:16px 0}
    .hero video{width:100%;height:360px;object-fit:cover;border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,.08)}
    .side{display:flex;flex-direction:column;gap:12px;justify-content:center}
    .side h2{margin:0 0 6px;font-size:36px;color:var(--azul)}
    .pill{display:inline-flex;gap:8px;align-items:center;padding:10px 12px;border-radius:12px;border:1px solid #dbe2ea;background:#fff;box-shadow:0 6px 18px rgba(0,0,0,.05);font-weight:600}
    .pill img{width:18px;height:18px}
    .insta{color:#C13584}
    .wa{color:#128C7E}

    /* TOOLS */
    .tools{background:var(--gris);padding:14px 0;border-top:1px solid #e7ebf0;border-bottom:1px solid #e7ebf0}
    .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    #buscador{flex:1;min-width:220px;padding:10px;border-radius:8px;border:1px solid #dbe2ea}
    .categorias{display:flex;gap:8px;flex-wrap:wrap}
    .categorias button{padding:8px 12px;border-radius:8px;border:1px solid #dbe2ea;background:#fff;cursor:pointer}
    .categorias button.active{background:var(--azul);color:#fff;border-color:var(--azul)}

    /* GRID */
    #contenedor-productos{display:grid;grid-template-columns:repeat(auto-fill,minmax(230px,1fr));gap:16px;padding:20px 0}
    .producto{background:#fff;border:1px solid #e8edf3;border-radius:12px;overflow:hidden;box-shadow:0 6px 18px rgba(0,0,0,.05)}
    .producto img{width:100%;height:170px;object-fit:cover}
    .producto h3{font-size:16px;margin:10px 12px}
    .producto .meta{display:flex;justify-content:space-between;align-items:center;margin:0 12px 12px}
    .producto button{margin:0 12px 14px 12px;width:calc(100% - 24px)}
    footer{background:#0b1f42;color:#cfe1ff;padding:24px 0;margin-top:16px}
    footer a{color:#cfe1ff;text-decoration:underline}
    #notificacion{position:fixed;right:16px;bottom:16px;background:#111;color:#fff;padding:10px 14px;border-radius:10px;display:none}
    @media (max-width:900px){.hero{grid-template-columns:1fr}}
  </style>
</head>
<body>

<header class="topbar">
  <div class="container wrap">
    <a class="brand" href="index.html">
      <img src="img/logo-el-catre.jpg" alt="El Catre S.R.L">
      <strong>El Catre — Mueblería</strong>
    </a>
    <nav class="menu">
      <a href="index.html">Inicio</a>
      <a href="#catalogo">Productos</a>
      <a href="carrito.html">Carrito</a>
      <a href="https://wa.me/59844645043" target="_blank" rel="noopener">Contacto</a>
      <a href="nosotros.html">Nosotros</a>
      <a href="politicas.html">Políticas</a>
    </nav>
    <div class="auth" id="auth-box">
      <a class="btn" href="login.html">Login</a>
      <a class="btn white" href="register.html">Registrarse</a>
    </div>
  </div>
</header>

<section class="container hero">
  <video src="media/el-catre.mp4" autoplay muted loop playsinline></video>
  <aside class="side">
    <h2>Mueblería</h2>
    <div class="pill wa">
      <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/whatsapp.svg" alt="">
      <a href="https://wa.me/59844645043" target="_blank" rel="noopener">WhatsApp: 4464-5043</a>
    </div>
    <div class="pill insta">
      <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/instagram.svg" alt="">
      <a href="https://www.instagram.com/elcatre.srl" target="_blank" rel="noopener">@elcatre.srl</a>
    </div>
  </aside>
</section>

<section class="tools" id="catalogo">
  <div class="container">
    <div class="row">
      <input id="buscador" type="search" placeholder="Buscar productos…">
      <div id="tabs-categorias" class="categorias"></div>
    </div>
  </div>
</section>

<main class="container">
  <div id="contenedor-productos"></div>
</main>

<footer>
  <div class="container">
    <p>© El Catre S.R.L — Mueblería. Santa Clara de Olimar. Tel: 4464-5043</p>
    <p>Seguinos en <a href="https://www.instagram.com/elcatre.srl" target="_blank">Instagram</a></p>
  </div>
</footer>

<div id="notificacion"></div>

<script>
  const API = '../backend/api.php';

  async function pintarAuth(){
    try{
      const r = await fetch(API+'?action=auth_me',{credentials:'include'});
      const j = await r.json();
      const box = document.getElementById('auth-box');
      if(j.authenticated){
        box.innerHTML = `
          <span>Hola, <strong>${j.user.nombre}</strong></span>
          <button class="btn" id="btn-logout">Cerrar sesión</button>
        `;
        document.getElementById('btn-logout').onclick = async ()=>{
          await fetch(API,{method:'POST',body:new URLSearchParams({action:'auth_logout'}),credentials:'include'});
          location.reload();
        };
      }else{
        box.innerHTML = `<a class="btn" href="login.html">Login</a>
                         <a class="btn white" href="register.html">Registrarse</a>`;
      }
    }catch(_){}
  }

  // Integración con tu data.js (cachear productos para el buscador)
  let productosCache = [];
  const _renderCatalogo = window.renderCatalogo;
  window.renderCatalogo = function(productos, q='', cat='todos'){ productosCache=productos; return _renderCatalogo(productos,q,cat); };

  document.addEventListener('DOMContentLoaded', ()=>{
    pintarAuth();
    const q = document.getElementById('buscador');
    if(q){ q.addEventListener('input', ()=>{
      const active = document.querySelector('.categorias button.active')?.getAttribute('data-cat') || 'todos';
      renderCatalogo(productosCache || [], q.value, active);
    });}
  });
</script>

<script src="data.js"></script>
</body>
</html>
